<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# game: http://ogp.me/ns/game#">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kahoot | <%= gameId.game_name %></title>
    <script>
        const darkTheme = `<%= darkTheme %>`;
        if (darkTheme === 'on') {
            document.documentElement.classList.add('darkTheme');
        } else {
            document.documentElement.classList.remove('darkTheme');
        }
    </script>
    <meta property="og:title" content="–ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ –∏–≥—Ä–µ –∏ –Ω–∞—á–Ω–∏ –≤–∏–∫—Ç–æ—Ä–∏–Ω—É!" />
    <meta property="og:description" content="–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ –∏–≥—Ä–µ –∏ –ø—Ä–æ–≤–µ—Ä—å —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è –≤ –≤–µ—Å—ë–ª–æ–π –≤–∏–∫—Ç–æ—Ä–∏–Ω–µ!" />
    <meta property="og:image" content="<%= ngrokLink %>/images/kahoot2.png" />
    <meta property="og:url" content="<%= ngrokLink %>/<%= gameId._id %>" />
    <meta property="og:type" content="game" />
    <meta property="og:locale" content="ru_RU" />
    <link rel="icon" type="image/png" href="/images/icon.png">
    <link rel="stylesheet" href="/stylesheets/game.css">
    <link rel="stylesheet" href="/stylesheets/friends.css">
    <link rel="stylesheet" href="/stylesheets/theme.css">
    <link rel="stylesheet" href="/stylesheets/alert.css">
</head>
<script>
    const game = '<%= myGame %>';
    const id = '<%= user.id %>';
    const sendId = '<%= user.id %>';
    const name = '<%= user.name %>';
    const gamesId = `<%= gameId._id %>`;
    const gamesExpiresInSeconds = `<%= gameId.game_expiresInSeconds %>`;
    const gameMaxQuestions = `<%= gameId.game_questions.length %>`;
    const gameStartType = `<%= gameId.game_start_type %>`;
    const authorId = `<%= gameId.game_author.id %>`;
    const sounds = '<%= soundTrack %>';
    const localeType = '<%= locale %>';
    const pushNotifications = `<%= notifications %>`;
</script>
<body>
<main class="game">
    <div class="info-container">
        <div class="info-container-btn">
            <button onclick="window.location.replace('/');" class="button">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left-icon lucide-arrow-left"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>
            </button>
            <button type="button" class="button" onclick="window.location.reload();" id="refresh">
                <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        fill="currentColor"
                        class="bi bi-arrow-repeat"
                        viewBox="0 0 16 16">
                    <path
                            d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"
                    ></path>
                    <path
                            fill-rule="evenodd"
                            d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"
                    ></path>
                </svg>
            </button>
        </div>

        <div class="users-online">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-users-icon lucide-users"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><path d="M16 3.128a4 4 0 0 1 0 7.744"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><circle cx="9" cy="7" r="4"/></svg>
        </div>
        <div id="usersCount">
            <section class="dots-container" id="usersCountLoaderSvg">
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
            </section>
        </div>
        <div id="userInfo"></div>
    </div>

    <div id="questions" hidden>
        <div id="gameQuestions"></div>
        <div id="gameTimer">
            <p class="game-timer"></p>
        </div>
        <div id="correctAnswersCount" class="game-correct-answers-count"></div>
        <div id="answersCount" class="answers-count"></div>
    </div>
    <div class="user-info">
        <% if (gameId.game_author.id === user.id) {%>
            <div class="banned-users">
                <button id="openBannedPlayersMenu">–ë–∞–Ω–ª–∏—Å—Ç</button>
            </div>
        <% } %>
            <% if (gameId.game_author.id === user.id && gameId.game_start_type === 'Manually') {%>
                <button onclick="manualGameLaunch()">–°—Ç–∞—Ä—Ç</button>
            <% } %>
        <div class="my-friends">
            <button id="openFriendListMenu">–î—Ä—É–∑—å—è</button>
        </div>
    </div>
    <div id="infoContainer">
        <div class="loader">
            <div class="bar1"></div>
            <div class="bar2"></div>
            <div class="bar3"></div>
            <div class="bar4"></div>
            <div class="bar5"></div>
            <div class="bar6"></div>
            <div class="bar7"></div>
            <div class="bar8"></div>
            <div class="bar9"></div>
            <div class="bar10"></div>
            <div class="bar11"></div>
            <div class="bar12"></div>
        </div>
        <span id="info">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
    </div>
    <div class="overlay" id="overlay">
        <table class="leaderboard">
            <thead>
            <tr>
                <th>–ú–µ—Å—Ç–æ</th>
                <th>–ù–∏–∫–Ω–µ–π–º</th>
                <th>–û—Ç–≤–µ—Ç—ã</th>
                <th>–í—Ä–µ–º—è</th>
            </tr>
            </thead>
            <tbody id="leaderBoard"></tbody>

            <tfoot>
            <tr>
                <td colspan="4" class="leaderboard-footer">
                    <div style="text-align: center; margin-left: auto; margin-right: auto; display: block;">
                        <p><strong id="winner"></strong></p>
                        <button class="exit-btn" onclick="window.location.assign('/')">–í—ã–π—Ç–∏ –∏–∑ –∏–≥—Ä—ã</button>
                    </div>
                </td>
            </tr>
            </tfoot>
        </table>
    </div>

    <div class="overlay" id="overlayFriendListMenu">
        <div id="friendListMenu">
            <h2 style="text-align: center">–°–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π</h2>
            <svg class="loaderSvg" viewBox="25 25 50 50" id="friendsLoaderSvg">
                <circle r="20" cy="50" cx="50"></circle>
            </svg>
            <div class="card">
                <div id="myFriendsCount" class="wrapper"></div>
            </div>
            <button class="close-btn" id="closeFriendsMenu">X</button>
        </div>
    </div>
    <% if (gameId.game_author.id === user.id) {%>
        <div class="overlay" id="overlayBannedUsersMenu">
            <div id="bannedPlayersMenu">
                <h2 style="text-align: center">–°–ø–∏—Å–æ–∫ –∑–∞–±–∞–Ω–µ–Ω–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤</h2>
                <svg class="loaderSvg" viewBox="25 25 50 50" id="banLoaderSvg">
                    <circle r="20" cy="50" cx="50"></circle>
                </svg>
                <div class="card">
                    <br>
                    <br>
                    <br>
                    <br>
                    <div id="bannedUsersCount"></div>
                </div>
                <button class="close-btn" id="closeBannedUsersMenu">X</button>
            </div>
        </div>
    <% } %>
    <div class="game-pin">
        <span>
            <p>–ö–æ–¥ –∏–≥—Ä—ã:</p>
            <p style="font-weight: 600"><%= gameId._id%></p>
        </span>
    </div>

    <div class="answer-container" id="wrongAnswerContainer" hidden>
        <div class="answer-emoji-container">
            <div class="answer-message">–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç!</div>
            <div class="answer-emoji">‚ùå</div>
        </div>
    </div>

    <div class="answer-container" id="timeIsUp" hidden>
        <div class="answer-emoji-container">
            <div class="answer-message">–í—Ä–µ–º—è –∏—Å—Ç–µ–∫–ª–æ!</div>
            <div class="answer-emoji">‚è≥</div>
        </div>
    </div>

    <div class="answer-container" id="correctAnswerContainer" hidden>
        <div class="answer-emoji-container">
            <div class="answer-message">–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç!</div>
            <div class="answer-emoji">‚úÖ</div>
        </div>
    </div>

    <div id="waitAllPlayer" hidden>
        <div class="ü§ö">
            <div class="üëâ"></div>
            <div class="üëâ"></div>
            <div class="üëâ"></div>
            <div class="üëâ"></div>
            <div class="üå¥"></div>
            <div class="üëç"></div>
        </div>
        <p>–ü–æ–¥–æ–∂–¥–∏—Ç–µ, –ø–æ–∫–∞ –≤—Å–µ –∏–≥—Ä–æ–∫–∏ –∑–∞–∫–æ–Ω—á–∞—Ç –∏–≥—Ä—É...</p>
    </div>
</main>

<div class="toast-container" id="toast-container"></div>
<div class="new-barrier" id="barrier" hidden></div>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
<script defer src="/socket.io/socket.io.js"></script>
<script defer src="/javascripts/game.js"></script>
<script defer src="/javascripts/socket.js"></script>
<script defer src="/javascripts/timer.js"></script>
<script defer src="/javascripts/friends.js"></script>
<script defer src="/javascripts/alert.js"></script>
<script defer src="/javascripts/warnings.js"></script>
</body>
</html>
